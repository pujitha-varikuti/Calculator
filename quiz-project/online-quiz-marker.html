<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Online Quiz Maker</title>
    <style>
        :root {
            --primary-color: #4285f4;
            --secondary-color: #34a853;
            --danger-color: #ea4335;
            --light-color: #f8f9fa;
            --dark-color: #343a40;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background-color: var(--primary-color);
            color: white;
            padding: 20px 0;
            margin-bottom: 30px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        header .container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .auth-buttons button {
            margin-left: 10px;
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
        }
        
        .login-btn {
            background-color: white;
            color: var(--primary-color);
        }
        
        .register-btn {
            background-color: var(--secondary-color);
            color: white;
        }
        
        .logout-btn {
            background-color: var(--danger-color);
            color: white;
        }
        
        .welcome-message {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .welcome-message h1 {
            font-size: 2.5rem;
            margin-bottom: 20px;
            color: var(--primary-color);
        }
        
        .welcome-message p {
            font-size: 1.2rem;
            margin-bottom: 30px;
        }
        
        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .action-btn {
            padding: 12px 24px;
            font-size: 1.1rem;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .create-quiz-btn {
            background-color: var(--primary-color);
            color: white;
        }
        
        .take-quiz-btn {
            background-color: var(--secondary-color);
            color: white;
        }
        
        .action-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 1000;
            overflow-y: auto;
        }
        
        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 8px;
            width: 90%;
            max-width: 800px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            position: relative;
        }
        
        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.5rem;
            cursor: pointer;
            color: #777;
        }
        
        .close-btn:hover {
            color: #333;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        .form-control {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
        }
        
        .form-control:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 2px rgba(66, 133, 244, 0.2);
        }
        
        .option-group {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .option-group input[type="radio"] {
            margin-right: 10px;
        }
        
        .option-group input[type="text"] {
            flex-grow: 1;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .add-option-btn, .add-question-btn, .submit-quiz-btn, .next-question-btn, .submit-answers-btn {
            padding: 10px 20px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            margin-top: 10px;
        }
        
        .add-option-btn:hover, .add-question-btn:hover, .submit-quiz-btn:hover, .next-question-btn:hover, .submit-answers-btn:hover {
            background-color: #3367d6;
        }
        
        .quiz-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .quiz-card {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        
        .quiz-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .quiz-card h3 {
            margin-bottom: 10px;
            color: var(--primary-color);
        }
        
        .quiz-card p {
            margin-bottom: 15px;
            color: #666;
        }
        
        .take-quiz-btn-card {
            display: inline-block;
            padding: 8px 16px;
            background-color: var(--secondary-color);
            color: white;
            text-decoration: none;
            border-radius: 4px;
            font-weight: 500;
        }
        
        .quiz-results {
            text-align: center;
            padding: 30px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            max-width: 600px;
            margin: 0 auto;
        }
        
        .quiz-results h2 {
            color: var(--primary-color);
            margin-bottom: 20px;
        }
        
        .score {
            font-size: 2rem;
            font-weight: bold;
            margin: 20px 0;
            color: var(--secondary-color);
        }
        
        .result-item {
            margin-bottom: 15px;
            text-align: left;
            padding: 15px;
            border: 1px solid #eee;
            border-radius: 4px;
        }
        
        .correct {
            background-color: rgba(52, 168, 83, 0.1);
            border-left: 4px solid var(--secondary-color);
        }
        
        .incorrect {
            background-color: rgba(234, 67, 53, 0.1);
            border-left: 4px solid var(--danger-color);
        }
        
        .back-to-quizzes-btn {
            display: inline-block;
            margin-top: 20px;
            padding: 10px 20px;
            background-color: var(--primary-color);
            color: white;
            text-decoration: none;
            border-radius: 4px;
            font-weight: 500;
        }
        
        @media (max-width: 768px) {
            .action-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .quiz-list {
                grid-template-columns: 1fr;
            }
            
            .modal-content {
                width: 95%;
                margin: 10% auto;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>Online Quiz Maker</h1>
            <div class="auth-buttons" id="authButtons">
                <button class="login-btn" onclick="openModal('loginModal')">Login</button>
                <button class="register-btn" onclick="openModal('registerModal')">Register</button>
            </div>
            <div class="auth-buttons" id="userSection" style="display: none;">
                <span id="usernameDisplay" style="color: white; margin-right: 10px;"></span>
                <button class="logout-btn" onclick="logout()">Logout</button>
            </div>
        </div>
    </header>

    <div class="container">
        <section id="homePage">
            <div class="welcome-message">
                <h1>Welcome to Online Quiz Maker</h1>
                <p>Create your own quizzes or take quizzes created by others. Test your knowledge and share with friends!</p>
            </div>
            
            <div class="action-buttons">
                <button class="action-btn create-quiz-btn" onclick="openModal('createQuizModal')">Create a Quiz</button>
                <button class="action-btn take-quiz-btn" onclick="showQuizList()">Take a Quiz</button>
            </div>
            
            <div id="quizListContainer" style="display: none;">
                <h2>Available Quizzes</h2>
                <div class="quiz-list" id="quizList">
                    <!-- Quizzes will be loaded here -->
                </div>
            </div>
        </section>
        
        <section id="quizTakingSection" style="display: none;">
            <div id="quizContent">
                <!-- Quiz questions will be loaded here -->
            </div>
        </section>
        
        <section id="quizResultsSection" style="display: none;">
            <div class="quiz-results" id="quizResults">
                <!-- Quiz results will be loaded here -->
            </div>
        </section>
    </div>

    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal('loginModal')">&times;</span>
            <h2>Login</h2>
            <form id="loginForm">
                <div class="form-group">
                    <label for="loginUsername">Username</label>
                    <input type="text" id="loginUsername" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="loginPassword">Password</label>
                    <input type="password" id="loginPassword" class="form-control" required>
                </div>
                <button type="submit" class="submit-quiz-btn">Login</button>
            </form>
        </div>
    </div>

    <!-- Registration Modal -->
    <div id="registerModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal('registerModal')">&times;</span>
            <h2>Register</h2>
            <form id="registerForm">
                <div class="form-group">
                    <label for="registerUsername">Username</label>
                    <input type="text" id="registerUsername" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="registerEmail">Email</label>
                    <input type="email" id="registerEmail" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="registerPassword">Password</label>
                    <input type="password" id="registerPassword" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="registerConfirmPassword">Confirm Password</label>
                    <input type="password" id="registerConfirmPassword" class="form-control" required>
                </div>
                <button type="submit" class="submit-quiz-btn">Register</button>
            </form>
        </div>
    </div>

    <!-- Create Quiz Modal -->
    <div id="createQuizModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal('createQuizModal')">&times;</span>
            <h2>Create a New Quiz</h2>
            <form id="quizForm">
                <div class="form-group">
                    <label for="quizTitle">Quiz Title</label>
                    <input type="text" id="quizTitle" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="quizDescription">Description</label>
                    <textarea id="quizDescription" class="form-control" rows="3"></textarea>
                </div>
                
                <div id="questionsContainer">
                    <!-- Questions will be added here -->
                </div>
                
                <button type="button" class="add-question-btn" onclick="addQuestion()">Add Question</button>
                <button type="submit" class="submit-quiz-btn">Submit Quiz</button>
            </form>
        </div>
    </div>

    <script>
        // Current user data
        let currentUser = null;
        let quizzes = JSON.parse(localStorage.getItem('quizzes')) || [];
        let users = JSON.parse(localStorage.getItem('users')) || [];
        let currentQuiz = null;
        let currentQuestionIndex = 0;
        let userAnswers = [];
        
        // DOM Elements
        const homePage = document.getElementById('homePage');
        const quizListContainer = document.getElementById('quizListContainer');
        const quizTakingSection = document.getElementById('quizTakingSection');
        const quizResultsSection = document.getElementById('quizResultsSection');
        const quizList = document.getElementById('quizList');
        const quizContent = document.getElementById('quizContent');
        const quizResults = document.getElementById('quizResults');
        const authButtons = document.getElementById('authButtons');
        const userSection = document.getElementById('userSection');
        const usernameDisplay = document.getElementById('usernameDisplay');
        
        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            // Check if user is logged in
            const loggedInUser = localStorage.getItem('loggedInUser');
            if (loggedInUser) {
                currentUser = JSON.parse(loggedInUser);
                updateUserUI();
            }
            
            // Event listeners for forms
            document.getElementById('loginForm').addEventListener('submit', handleLogin);
            document.getElementById('registerForm').addEventListener('submit', handleRegister);
            document.getElementById('quizForm').addEventListener('submit', handleQuizSubmit);
        });
        
        // Modal functions
        function openModal(modalId) {
            document.getElementById(modalId).style.display = 'block';
        }
        
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }
        
        // Authentication functions
        function handleLogin(e) {
            e.preventDefault();
            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;
            
            const user = users.find(u => u.username === username && u.password === password);
            
            if (user) {
                currentUser = user;
                localStorage.setItem('loggedInUser', JSON.stringify(user));
                updateUserUI();
                closeModal('loginModal');
                alert('Login successful!');
            } else {
                alert('Invalid username or password');
            }
        }
        
        function handleRegister(e) {
            e.preventDefault();
            const username = document.getElementById('registerUsername').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const confirmPassword = document.getElementById('registerConfirmPassword').value;
            
            if (password !== confirmPassword) {
                alert('Passwords do not match');
                return;
            }
            
            if (users.some(u => u.username === username)) {
                alert('Username already exists');
                return;
            }
            
            const newUser = {
                id: Date.now().toString(),
                username,
                email,
                password
            };
            
            users.push(newUser);
            localStorage.setItem('users', JSON.stringify(users));
            
            alert('Registration successful! Please login.');
            closeModal('registerModal');
        }
        
        function logout() {
            currentUser = null;
            localStorage.removeItem('loggedInUser');
            updateUserUI();
        }
        
        function updateUserUI() {
            if (currentUser) {
                authButtons.style.display = 'none';
                userSection.style.display = 'block';
                usernameDisplay.textContent = currentUser.username;
            } else {
                authButtons.style.display = 'block';
                userSection.style.display = 'none';
            }
        }
        
        // Quiz creation functions
        function addQuestion() {
            const questionsContainer = document.getElementById('questionsContainer');
            const questionId = `question-${Date.now()}`;
            
            const questionDiv = document.createElement('div');
            questionDiv.className = 'form-group question-group';
            questionDiv.dataset.questionId = questionId;
            
            questionDiv.innerHTML = `
                <label>Question</label>
                <input type="text" class="form-control question-text" placeholder="Enter question text" required>
                
                <div class="options-container" id="${questionId}-options">
                    <div class="option-group">
                        <input type="radio" name="${questionId}-correct" value="0" required>
                        <input type="text" class="form-control option-text" placeholder="Option 1" required>
                    </div>
                    <div class="option-group">
                        <input type="radio" name="${questionId}-correct" value="1" required>
                        <input type="text" class="form-control option-text" placeholder="Option 2" required>
                    </div>
                </div>
                
                <button type="button" class="add-option-btn" onclick="addOption('${questionId}')">Add Option</button>
                <button type="button" class="btn btn-danger" onclick="removeQuestion('${questionId}')" style="margin-left: 10px; padding: 5px 10px; background-color: #dc3545; color: white; border: none; border-radius: 4px;">Remove Question</button>
            `;
            
            questionsContainer.appendChild(questionDiv);
        }
        
        function addOption(questionId) {
            const optionsContainer = document.getElementById(`${questionId}-options`);
            const optionCount = optionsContainer.children.length;
            
            const optionDiv = document.createElement('div');
            optionDiv.className = 'option-group';
            
            optionDiv.innerHTML = `
                <input type="radio" name="${questionId}-correct" value="${optionCount}" required>
                <input type="text" class="form-control option-text" placeholder="Option ${optionCount + 1}" required>
            `;
            
            optionsContainer.appendChild(optionDiv);
        }
        
        function removeQuestion(questionId) {
            const questionDiv = document.querySelector(`.question-group[data-question-id="${questionId}"]`);
            questionDiv.remove();
        }
        
        function handleQuizSubmit(e) {
            e.preventDefault();
            
            if (!currentUser) {
                alert('Please login to create a quiz');
                return;
            }
            
            const title = document.getElementById('quizTitle').value;
            const description = document.getElementById('quizDescription').value;
            const questionGroups = document.querySelectorAll('.question-group');
            
            if (questionGroups.length === 0) {
                alert('Please add at least one question');
                return;
            }
            
            const questions = [];
            
            questionGroups.forEach(group => {
                const questionText = group.querySelector('.question-text').value;
                const options = Array.from(group.querySelectorAll('.option-text')).map(opt => opt.value);
                const correctAnswerIndex = parseInt(group.querySelector(`input[name="${group.dataset.questionId}-correct"]:checked`).value);
                
                questions.push({
                    text: questionText,
                    options,
                    correctAnswer: correctAnswerIndex
                });
            });
            
            const newQuiz = {
                id: Date.now().toString(),
                title,
                description,
                creator: currentUser.username,
                createdAt: new Date().toISOString(),
                questions
            };
            
            quizzes.push(newQuiz);
            localStorage.setItem('quizzes', JSON.stringify(quizzes));
            
            alert('Quiz created successfully!');
            closeModal('createQuizModal');
            document.getElementById('quizForm').reset();
            document.getElementById('questionsContainer').innerHTML = '';
        }
        
        // Quiz taking functions
        function showQuizList() {
            homePage.style.display = 'block';
            quizListContainer.style.display = 'block';
            quizTakingSection.style.display = 'none';
            quizResultsSection.style.display = 'none';
            
            quizList.innerHTML = '';
            
            if (quizzes.length === 0) {
                quizList.innerHTML = '<p>No quizzes available yet. Be the first to create one!</p>';
                return;
            }
            
            quizzes.forEach(quiz => {
                const quizCard = document.createElement('div');
                quizCard.className = 'quiz-card';
                
                quizCard.innerHTML = `
                    <h3>${quiz.title}</h3>
                    <p>${quiz.description || 'No description'}</p>
                    <p><small>Created by: ${quiz.creator}</small></p>
                    <p><small>Questions: ${quiz.questions.length}</small></p>
                    <a href="#" class="take-quiz-btn-card" onclick="startQuiz('${quiz.id}')">Take Quiz</a>
                `;
                
                quizList.appendChild(quizCard);
            });
        }
        
        function startQuiz(quizId) {
            currentQuiz = quizzes.find(q => q.id === quizId);
            currentQuestionIndex = 0;
            userAnswers = [];
            
            homePage.style.display = 'none';
            quizListContainer.style.display = 'none';
            quizTakingSection.style.display = 'block';
            quizResultsSection.style.display = 'none';
            
            showQuestion();
        }
        
        function showQuestion() {
            const question = currentQuiz.questions[currentQuestionIndex];
            
            quizContent.innerHTML = `
                <h2>${currentQuiz.title}</h2>
                <p>Question ${currentQuestionIndex + 1} of ${currentQuiz.questions.length}</p>
                <div class="question-container">
                    <h3>${question.text}</h3>
                    <form id="answerForm">
                        ${question.options.map((option, index) => `
                            <div class="option-group" style="margin: 15px 0;">
                                <input type="radio" name="answer" id="option-${index}" value="${index}">
                                <label for="option-${index}" style="margin-left: 10px; cursor: pointer;">${option}</label>
                            </div>
                        `).join('')}
                    </form>
                </div>
                <button class="next-question-btn" onclick="nextQuestion()">
                    ${currentQuestionIndex === currentQuiz.questions.length - 1 ? 'Submit Quiz' : 'Next Question'}
                </button>
            `;
        }
        
        function nextQuestion() {
            const selectedOption = document.querySelector('input[name="answer"]:checked');
            
            if (!selectedOption) {
                alert('Please select an answer');
                return;
            }
            
            userAnswers.push(parseInt(selectedOption.value));
            
            if (currentQuestionIndex < currentQuiz.questions.length - 1) {
                currentQuestionIndex++;
                showQuestion();
            } else {
                showResults();
            }
        }
        
        function showResults() {
            let score = 0;
            const results = [];
            
            currentQuiz.questions.forEach((question, index) => {
                const isCorrect = userAnswers[index] === question.correctAnswer;
                if (isCorrect) score++;
                
                results.push({
                    question: question.text,
                    userAnswer: question.options[userAnswers[index]],
                    correctAnswer: question.options[question.correctAnswer],
                    isCorrect
                });
            });
            
            const percentage = Math.round((score / currentQuiz.questions.length) * 100);
            
            quizResults.innerHTML = `
                <h2>Quiz Results: ${currentQuiz.title}</h2>
                <div class="score">${percentage}%</div>
                <p>You got ${score} out of ${currentQuiz.questions.length} questions correct</p>
                
                <h3>Question Breakdown:</h3>
                ${results.map((result, index) => `
                    <div class="result-item ${result.isCorrect ? 'correct' : 'incorrect'}">
                        <p><strong>Question ${index + 1}:</strong> ${result.question}</p>
                        <p>Your answer: ${result.userAnswer}</p>
                        <p>Correct answer: ${result.correctAnswer}</p>
                    </div>
                `).join('')}
                
                <a href="#" class="back-to-quizzes-btn" onclick="showQuizList()">Back to Quizzes</a>
            `;
            
            quizTakingSection.style.display = 'none';
            quizResultsSection.style.display = 'block';
        }
        
        // Initialize with one question
        window.onload = function() {
            if (currentUser) {
                updateUserUI();
            }
        };
    </script>
</body>
</html>